@{
    ViewData["Title"] = "Friends Page";
}

@model ICollection<SisyphusChat.Core.Models.UserModel>

<div class="friends-page-container">
    <div class="friends-header">
        <h2>Friends</h2>
        <div class="header-buttons">
            <a class="add-friend-button" asp-area="" asp-controller="Friends" asp-action="Add" title="Add Friends">+</a>
            <a class="manage-requests-button" asp-area="" asp-controller="Friends" asp-action="Requests" title="Manage Requests">
                <i class="fas fa-users"></i>
            </a>
        </div>
    </div>

    <div class="friends-list">
        @foreach (var friend in Model)
        {
            <div class="friend-card">
                <div class="profile-container">
                    @if (friend.Picture.Length > 0)
                    {
                        var base64Image = Convert.ToBase64String(@friend.Picture);
                        var imgSrc = $"data:image/jpeg;base64,{base64Image}";
                        <img class="profile-image" src="@imgSrc" alt="User Avatar" />
                    }
                    else
                    {
                        <img class="profile-image" src="~/images/default_pfp.jpg" alt="Default Avatar" />
                    }

                    <div class="status-dot @(friend.IsOnline ? "online" : "offline")"></div>
                </div>

                <div class="friend-info">
                    <p class="friend-name">
                        <a href="@Url.Action("Profile", "Friends", new { username = friend.UserName })" class="text-blue-500 hover:underline">
                            @friend.UserName
                        </a>
                    </p>
                </div>

                <form method="post" asp-action="RemoveFriend" asp-controller="Friends" style="display:inline;">
                    <input type="hidden" name="friendId" value="@friend.Id" />
                    <button type="submit" class="btn remove-button">Remove</button>
                </form>
            </div>
        }
    </div>
</div>

<style scoped>
    .friends-page-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        min-height: 100vh;
    }

    .friends-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 30px;
        padding-bottom: 15px;
    }

    .header-buttons {
        display: flex;
        gap: 15px;
    }

    .add-friend-button, 
    .manage-requests-button {
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: all 0.3s ease;
    }

    .add-friend-button {
        font-size: 24px;
        padding-bottom: 4px;
    }

    .friends-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 20px;
        padding: 20px 0;
    }

    .friend-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 15px;
        border-radius: 15px;
        transition: transform 0.3s ease;
    }

    .friend-card:hover {
        transform: translateY(-5px);
    }

    .profile-container {
        position: relative;
        margin-bottom: 15px;
        width: 80px;
        height: 80px;
    }

    .profile-image {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .profile-image:hover {
        transform: scale(1.05);
    }

    .status-dot {
        position: absolute;
        right: 0;
        bottom: 0;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        border-width: 2px;
        border-style: solid;
    }

    .friend-info {
        width: 100%;
        text-align: center;
        margin: 10px 0;
    }

    .friend-name {
        font-size: 1.1rem;
        font-weight: 600;
        margin: 0;
    }

    .friend-name a:hover {
        text-decoration: none;
    }

    .remove-button {
        padding: 6px 12px;
        border-radius: 20px;
        border: none;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        margin-top: 10px;
    }
</style>
